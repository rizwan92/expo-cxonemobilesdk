# Customer & Custom Fields

`src/api/customer.ts` and portions of `src/api/thread.ts` expose identity, OAuth, visitor IDs, and scoped custom fields. These values live only for the current CXoneChat session; calling `Connection.signOut()` clears them on both platforms.

## Identity & OAuth

```ts
import { Customer } from 'expo-cxonemobilesdk';

Customer.setName('Jane', 'Doe');
Customer.setIdentity('123', 'Jane', 'Doe');
Customer.setDeviceToken(pushToken);
Customer.setAuthorizationCode(codeFromBackend);
Customer.setCodeVerifier(pkceVerifier);
Customer.clearIdentity();
```

- Use `setName` if you only want to label the visitor.
- Use `setIdentity(id, firstName?, lastName?)` when your backend issues a persistent user ID.
- `setAuthorizationCode` + `setCodeVerifier` support CXone OAuth flows (native emits `authorizationChanged` events when status changes).
- `setDeviceToken` forwards APNs/FCM tokens so CXone can send push notifications.
- `Customer.getIdentity()` reads the cached value. iOS returns the SDK providerâ€™s identity, Android returns the last JS-provided identity because the SDK lacks a getter.
- `Customer.getVisitorId()` exposes the visitor ID generated by CXone, or `null` if unavailable.

## Custom fields

Customer-level custom fields apply to the visitor, while thread-level custom fields live on individual conversations.

```ts
// Customer scope
const current = Customer.getCustomFields();
await Customer.setCustomFields({ plan: 'gold', locale: 'en-US' });

// Thread scope (imported from `Thread`)
const threadFields = Thread.getCustomFields(threadId);
await Thread.updateCustomFields(threadId, { topic: 'support' });
```

Events:

- `Customer.EVENTS.CUSTOM_FIELDS_SET` maps to `customerCustomFieldsSet`.
- `Thread.EVENTS.CONTACT_CUSTOM_FIELDS_SET` maps to `contactCustomFieldsSet`.

Because CXone clears custom fields on sign-out, persist any values you need on your backend and reapply them after reconnecting.
